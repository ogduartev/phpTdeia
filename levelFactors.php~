<?php
require_once("block.php");

class levelFactors extends block
{
  
  function display()
  {
    if(isset($_SESSION['TDEIA_user_id']) and $_SESSION['TDEIA_user_id']>0)
    {  
      
      $maxLevel=0;
      $sql="SELECT MAX(level) AS MAX FROM factors WHERE project_id='".$_SESSION['TDEIA_project_id']."'";
      $result=mysql_query($sql) or die(mysql_error()."error : ".$sql);
      if($result and mysql_num_rows($result)>0)
      {
        $linea=mysql_fetch_array($result,MYSQL_ASSOC);
        $maxLevel=$linea['MAX'];
      }
      
      $level=0;
      if(isset($_POST['factorLevel'])){$level=$_POST['factorLevel'];}
      
      $str.="<div>\n";
      $str.="  <form method=\"post\" action=\"login.php\">\n";
      foreach($_POST as $K=>$V)
      {
        $str.="  <input type=\"hidden\" name=\"".$K."\" value=\"".$V."\">\n";    
      }
      $str.="  <input type=\"range\" name=\"factorLevel\" min=\"0\" max=\"".$maxLevel."\" value=\"".$level."\" onChange=\"submit();\">\n";
      $str.="  </form>\n";
      $str.="</div>\n";
      echo $str;
    }
  }
}
?>
